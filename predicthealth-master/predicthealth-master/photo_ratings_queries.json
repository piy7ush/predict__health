{"validate":{"d_from_diag":{"ig":{"any":"select uid,{medlong}_user_id as {med}uid,username,sum(d_from_diag_pregnancy>0) as gt_preg,sum(d_from_diag_pregnancy<0) as lt_preg,sum(d_from_diag_depression>0) as gt_depr,sum(d_from_diag_depression<0) as lt_depr,sum(d_from_diag_ptsd>0) as gt_ptsd,sum(d_from_diag_ptsd<0) as lt_ptsd,sum(d_from_diag_cancer>0)as gt_canc,sum(d_from_diag_cancer<0) as lt_canc from {metatab} group by username having (sum(d_from_diag_pregnancy<0)>0 and sum(d_from_diag_pregnancy>0)>0) or (sum(d_from_diag_depression<0)>0 and sum(d_from_diag_depression>0)>0) or (sum(d_from_diag_ptsd<0)>0 and sum(d_from_diag_ptsd>0)>0) or (sum(d_from_diag_cancer<0)>0 and sum(d_from_diag_cancer>0)>0) {ratings_q}","depression":"select uid, {medlong}_user_id as {med}uid, username, sum(d_from_diag_{cond} > 0) as gt_{cond}, sum(d_from_diag_{cond} < 0) as lt_{cond} from {metatab} group by username having (sum(d_from_diag_{cond} < 0) > 0 and sum(d_from_diag_{cond} > 0) > 0) {ratings_q}"}},"cesd":"select username, days_suspected, cesd from depression where cesd > {cutoff} and username in ({names})","date_range":"select hsv.username, hue, saturation, brightness, hsv.url, {metatab}.created_date, {cond}.diag_date, {metatab}.d_from_diag_{cond} as from_diag, {metatab}.d_from_susp_{cond} as from_susp from hsv inner join {metatab} on hsv.photo_id = {metatab}.id inner join {cond} on hsv.uid = {cond}.uid_usernames where date({metatab}.created_date) between date({cond}.diag_date, '-1 year') and  date({cond}.diag_date, '+1 year') and {metatab}.valid_url=200 and hsv.username in ({names})"}}